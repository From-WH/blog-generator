---
layout: node.js
title: Node.js Server
date: 2018-04-03 22:59:43
tags:
---

## HTTP协议的底层是由TCP和IP（TCP/IP）构建的
1.  [TCP 和 UDP 的区别是什么](https://www.nowcoder.com/questionTerminal/63c8b45c91a544bd8febc1f1ff02e3b5?toCommentId=73766 "null")
    简答：TCP 可靠、面向连接、相对 UDP 较慢；UDP 不可靠，不面向连接、相对 TCP 较快。搞定。
2.  [TCP 的三次握手指的是什么](https://github.com/jawil/blog/issues/14 "null")
    简答：每次建立连接前，客户端和服务端之前都要先进行三次对话才开始正式传输内容，三次对话大概是这样的：

    ```
     1. 客户端：我要连接你了，可以吗
     2. 服务端：嗯，我准备好了，连接我吧
     3. 客户端：那我连接你咯。
     4. 开始后面步骤
    ```

## IP网络协议（Internet Protocol）
只要你在互联网中，那么你就会有一个 IP。通俗上理解，IP 分为「内网 IP」 和「外网 IP」，以下图为例：
![image.png](https://upload-images.jianshu.io/upload_images/11007474-da2ddd5c1b38495d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)
路由器连上电信的服务器，那么路由器就会有一个「外网 IP」，比如「14.17.32.211」就是一个外网 IP。这就是你在互联网中的地址。
但是如果你重启路由器，那么你很有「可能」被重新分配一个「外网 IP」，也就是说 你的路由器没有「固定的外网 IP」
内网不能直接访问内网，反之亦然
路由器就是一个指路人，路由器也是内网与外网的必由之路，这也就是**路由**的来历
除了内网 IP 和外网 IP，还有两个特别特殊的 IP，就是本地 IP：127.0.0.1。本地 IP 永远表示设备自己。还有一个特别特殊的 IP：0.0.0.0，它不表示任何设备。

## 端口
想要访问一个设备（前提是你使用的是TCP或UDP协议，HTTP就是使用了TCP协议），只有IP是不够的必须还要有一个端口，端口只是一个编号，并不是一个硬件
一个服务器（硬件）不一定只提供一种服务，比如一个服务器既提供 HTTP 服务，又提供 FTP 服务，还提供 SMTP 服务（邮件服务），那么只用一个 IP 是无法告诉服务器你想要使用哪种服务。
所以这里有一个重要的原则：一个端口对应一个服务。

比如

要提供 HTTP 服务你最好使用 80 端口（能不能使用别的端口？可以，不过不建议你违反约定）
要提供 HTTPS 服务你最好使用 443 端口（能不能使用别的端口？可以，不过不建议你违反约定）
要提供 FTP 服务你最好使用 21 端口（能不能使用别的端口？可以，不过不建议你违反约定）

### 怎么知道应该使用什么端口？
[维基百科](https://zh.wikipedia.org/wiki/TCP/UDP%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A8#0.E5.88.B01023.E5.8F.B7.E7.AB.AF.E5.8F.A3 "null") 把 0 到 1023 号端口对应的服务都告诉你了

### 一共有多少端口？
每个机器一共有 65535（2的16次方减1）个端口（这是协议规定的）。不过这些端口的使用由一些规定：
0 到 1023（2的10次方减1）号端口是留给系统使用的，你只有拥有了管理员权限后，才能使用这 1024 个端口。
其他端口可以给普通用户使用
如果一个端口正在提供服务，也就是被占用了，那么就不能再使用这个端口。除非你先停掉正在占用这个端口的服务。

## 总结：
使用HTTP协议访问另外一个IP时，端口号和IP缺一不可
访问www.qq.com时我们没有输入端口号是因为浏览器帮我们添加上了

## Server（服务器）
用脚本就可以提供 HTTP 服务，不管是 Bash 脚本还是 Node.js 脚本都可以
模拟题，供以后复习：
写出一个 server.js 文件，满足以下功能

用户请求 / 时，返回 html 内容
1.该 html 内容里面由一个 css link 和一个 script
2.css link 会请求 /style.css，返回 css 内容
3.script 会请求 /main.js，返回 js 内容
4.请求 / /style.css /main.js 以外的路径，则一律返回 404 状态码
[点击查看代码](https://from-wh.github.io/node-demo/server.js)